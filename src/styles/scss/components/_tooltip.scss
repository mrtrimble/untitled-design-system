@use 'sass:meta';
@use 'sass:map';
@use '../tokens/tokens';

$TOKENS: meta.module-variables('tokens');

@layer components {
  .tooltip {
    --_translate-x: 0;
    --_translate-y: 0;
    --_height: 0;

    --_padding-inline: var(--tooltip-padding-inline, #{map.get($TOKENS, tooltip-padding-inline)});
    --_padding-block: var(--tooltip-padding-block, #{map.get($TOKENS, tooltip-padding-block)});
    --_background-color: var(--tooltip-background-color, #{map.get($TOKENS, tooltip-background-color)});
    --_text-color: var(--tooltip-text-color, #{map.get($TOKENS, tooltip-text-color)});
    --_border-color: var(--tooltip-border-color, #{map.get($TOKENS, tooltip-border-color)});
    --_border-radius: var(--tooltip-border-radius, #{map.get($TOKENS, tooltip-border-radius)});
    --_marker-height: var(--tooltip-marker-height, #{map.get($TOKENS, tooltip-marker-height)});

    @layer rules {
      inset-inline-start: calc(var(--_translate-x) - 0.75rem);
      inset-block-start: calc(var(--_translate-y) - var(--_height) - 3.5em);
      background-color: var(--_background-color);
      color: var(--_text-color);
      position: absolute;
      padding-inline: var(--_padding-inline);
      padding-block: var(--_padding-block);
      overflow: visible;
      border-color: var(--_border-color);
      border-radius: var(--_border-radius);
      justify-content: center;

      &::before {
        content: '';
        height: var(--_marker-height);
        aspect-ratio: 16/9;
        background: canvasText;
        position: absolute;
        bottom: calc(var(--_marker-height) * -1);
        clip-path: polygon(50% 100%, 0 0, 100% 0);
      }
    }

    @layer states {
      &.open,
      &:popover-open {
        display: flex;
      }
    }
  }
}
